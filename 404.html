<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Open YouSport</title>
    <script>
      const WEBSITE_URL = "https://yousportbeta.wordpress.com";
      const REDIRECT_TIMEOUT = 1500;

      function isInAppBrowser() {
        return /FB_IAB|FBAN|FBAV|Instagram|Twitter|Pinterest|Line|NAVER|kakaowork|KAKAOTALK|WhatsApp|Telegram|Messenger/i.test(
          navigator.userAgent
        );
      }

      window.onload = function () {
        const path = window.location.pathname;
        const cleanPath = path.replace(/^\/+/, "");
        const customSchemeLink = `yousport://${cleanPath}`;
        const websiteUrl = WEBSITE_URL + "/" + cleanPath;

        // For in-app browsers - show options and auto-redirect to website
        if (isInAppBrowser()) {
          document.getElementById("loading").style.display = "none";
          document.getElementById("inapp-section").style.display = "block";

          // Just set the href directly - sometimes this works better
          document.getElementById("app-button").href = customSchemeLink;
          document.getElementById("web-button").href = websiteUrl;

          // Auto-redirect to website after delay (most reliable option)
          setTimeout(function () {
            window.location = websiteUrl;
          }, 3000);
        } else {
          // For regular browsers, try to open app then fallback to website
          if (/android/i.test(navigator.userAgent)) {
            window.location.href = `intent://${cleanPath}#Intent;scheme=yousport;package=com.yousport.yousportapp;S.browser_fallback_url=${encodeURIComponent(
              websiteUrl
            )};end`;
          } else {
            window.location.href = customSchemeLink;
            setTimeout(function () {
              window.location.href = websiteUrl;
            }, REDIRECT_TIMEOUT);
          }
        }
      };
    </script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Arial, sans-serif;
        text-align: center;
        padding: 30px;
        margin: 0;
      }
      .container {
        max-width: 500px;
        margin: 0 auto;
      }
      .button {
        display: inline-block;
        padding: 12px 24px;
        background-color: #007bff;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-weight: bold;
        margin: 8px;
      }
      .web-button {
        background-color: #28a745;
      }
      #inapp-section {
        display: none;
      }
      .auto-text {
        font-size: 14px;
        color: #666;
        margin-top: 20px;
      }
      #attempt-message {
        display: none;
        margin-top: 15px;
        color: #856404;
        background-color: #fff3cd;
        padding: 10px;
        border-radius: 4px;
      }
      .alternative {
        margin-top: 25px;
        padding-top: 15px;
        border-top: 1px solid #ddd;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="loading">
        <p>Redirecting you to YouSport...</p>
      </div>

      <div id="inapp-section">
        <h2>Open in YouSport</h2>
        <p>Choose how you want to continue:</p>

        <!-- Use a elements with href instead of divs -->
        <a id="app-button" class="button" href="#">Open in App</a>
        <a id="web-button" class="button web-button" href="#"
          >View on Website</a
        >

        <p class="auto-text">
          Automatically redirecting to website in 3 seconds...
        </p>

        <div class="alternative">
          <p>
            If the buttons don't work, try copying this link and opening it in
            Safari/Chrome:
          </p>
          <code
            id="copy-link"
            style="
              word-break: break-all;
              background: #eee;
              padding: 8px;
              display: block;
            "
          ></code>
          <script>
            document.getElementById("copy-link").textContent =
              window.location.href;
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
